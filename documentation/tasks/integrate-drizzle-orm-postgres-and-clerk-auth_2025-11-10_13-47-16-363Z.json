[
  {
    "title": "Setup Database Infrastructure and Drizzle ORM",
    "description": "Configure PostgreSQL development database with Docker Compose and integrate Drizzle ORM into the backend Express application with proper schema definitions for chats and rag_stores tables.",
    "details": "Create docker-compose.yml at project root with PostgreSQL service configuration. Install drizzle-orm, drizzle-kit, pg, and @types/pg packages in backend. Create drizzle.config.ts in backend root for database connection configuration. Define database schemas in apps/backend/src/db/schema.ts with tables for 'chats' (id, userId, message, response, timestamp) and 'rag_stores' (id, userId, name, metadata, createdAt). Generate and run initial migrations using drizzle-kit. Set up database connection utility in apps/backend/src/db/connection.ts using environment variables for connection string.",
    "status": "pending",
    "test_strategy": "Test database connection on server startup. Verify schema creation by running migrations. Test CRUD operations on both tables using a simple test script.",
    "priority": "high",
    "ordinal": 0,
    "task_group_id": "9b90d080-83dd-4cb4-a254-118d3dda0eb8",
    "parent_task_id": null,
    "ai_result": null,
    "id": "ea46772d-3771-4d90-928f-72602f9ff451",
    "created_at": "2025-11-10T13:47:02.281800Z",
    "user_id": "user_2qaB6nlVH3R9QXhQZpt1nmVDymN",
    "subtasks": []
  },
  {
    "title": "Implement Clerk Authentication in Backend",
    "description": "Integrate Clerk authentication middleware into the Express backend to protect API routes and extract user information from JWT tokens.",
    "details": "Install @clerk/clerk-sdk-node package in backend. Create authentication middleware in apps/backend/src/middleware/auth.ts that validates Clerk JWT tokens and attaches user info to req.auth. Configure CORS to allow requests from frontend origin. Update apps/backend/src/index.ts to use the auth middleware globally or on specific protected routes. Set up environment variables for CLERK_SECRET_KEY in backend .env.local file. Add error handling for invalid or missing tokens.",
    "status": "pending",
    "test_strategy": "Test middleware with valid and invalid JWT tokens. Verify CORS configuration allows frontend requests. Test that protected routes return 401 for unauthenticated requests.",
    "priority": "high",
    "ordinal": 1,
    "task_group_id": "9b90d080-83dd-4cb4-a254-118d3dda0eb8",
    "parent_task_id": null,
    "ai_result": null,
    "id": "7eed5a75-ce66-4a56-81c6-eb7d8513fbd0",
    "created_at": "2025-11-10T13:47:02.281812Z",
    "user_id": "user_2qaB6nlVH3R9QXhQZpt1nmVDymN",
    "subtasks": []
  },
  {
    "title": "Create Protected API Endpoints for Data Persistence",
    "description": "Implement REST API endpoints for saving chat messages and RAG store metadata to the database with proper authentication and validation.",
    "details": "Create apps/backend/src/routes/chats.ts with POST /api/chats endpoint that accepts chat message data and saves to database with userId from req.auth. Create apps/backend/src/routes/ragstores.ts with POST /api/ragstores endpoint for saving RAG store metadata. Implement proper request validation using express-validator or similar. Add error handling for database operations and return appropriate HTTP status codes. Update apps/backend/src/index.ts to register the new routes. Ensure all endpoints are protected by the Clerk authentication middleware.",
    "status": "pending",
    "test_strategy": "Test endpoints with authenticated requests using valid JWT tokens. Verify data is correctly saved to database with proper userId association. Test error handling for invalid request data and database failures.",
    "priority": "medium",
    "ordinal": 2,
    "task_group_id": "9b90d080-83dd-4cb4-a254-118d3dda0eb8",
    "parent_task_id": null,
    "ai_result": null,
    "id": "8bfaba94-f9d9-41d9-910a-bdd436dc50b6",
    "created_at": "2025-11-10T13:47:02.281815Z",
    "user_id": "user_2qaB6nlVH3R9QXhQZpt1nmVDymN",
    "subtasks": []
  },
  {
    "title": "Integrate Clerk Authentication in Frontend",
    "description": "Add Clerk React SDK to the frontend application and implement mandatory login flow with pre-built UI components.",
    "details": "Install @clerk/clerk-react package in frontend. Wrap the root App component in apps/frontend/src/index.tsx with ClerkProvider using VITE_CLERK_PUBLISHABLE_KEY environment variable. Update apps/frontend/src/App.tsx to use SignedIn and SignedOut components to conditionally render the main application or SignIn component. Import and configure Clerk's pre-built SignIn component for unauthenticated users. Add environment variable VITE_CLERK_PUBLISHABLE_KEY to frontend .env.local file. Ensure the entire application is only accessible after authentication.",
    "status": "pending",
    "test_strategy": "Test that unauthenticated users see only the sign-in form. Verify successful authentication redirects to the main application. Test sign-out functionality and ensure users are redirected back to sign-in.",
    "priority": "medium",
    "ordinal": 3,
    "task_group_id": "9b90d080-83dd-4cb4-a254-118d3dda0eb8",
    "parent_task_id": null,
    "ai_result": null,
    "id": "98e4195f-05cd-4ad7-90a8-bb4c651c1a2e",
    "created_at": "2025-11-10T13:47:02.281817Z",
    "user_id": "user_2qaB6nlVH3R9QXhQZpt1nmVDymN",
    "subtasks": []
  },
  {
    "title": "Connect Frontend Components to Backend API",
    "description": "Create authenticated API service and integrate it into ChatInterface and RagStoreList components to persist user data.",
    "details": "Create apps/frontend/src/services/apiService.ts with methods for making authenticated API calls using useAuth hook to get JWT tokens. Implement functions for saving chats and RAG stores that include Authorization header with Bearer token. Update apps/frontend/components/ChatInterface.tsx to call the API service after sending messages to persist chat history. Update apps/frontend/components/RagStoreList.tsx to save RAG store metadata when stores are created. Add proper error handling and loading states for API calls. Ensure API calls are only made when user is authenticated.",
    "status": "pending",
    "test_strategy": "Test that chat messages are saved to backend after being sent. Verify RAG store metadata is persisted when stores are created. Test error handling for failed API calls and network issues. Verify JWT tokens are correctly included in request headers.",
    "priority": "medium",
    "ordinal": 4,
    "task_group_id": "9b90d080-83dd-4cb4-a254-118d3dda0eb8",
    "parent_task_id": null,
    "ai_result": null,
    "id": "9829f9ff-31b7-4e69-83e4-5b2c68793b73",
    "created_at": "2025-11-10T13:47:02.281819Z",
    "user_id": "user_2qaB6nlVH3R9QXhQZpt1nmVDymN",
    "subtasks": []
  }
]